<div class="flex flex-col flex-auto min-w-0 bg-gray-100 h-screen">
  <div class="flex-auto p-4 sm:p-10 overflow-auto">
    <div class="w-full">
      <div
        class="w-full flex sm:items-center justify-start mb-2 flex-col sm:flex-row"
      >
        <app-button-back [routeBack]="backRoute" class="mb-2"></app-button-back>
        <h2 class="text-2xl sm:text-3xl font-semibold tracking-tight leading-8">
          Asistencias de: {{ user.group }}
        </h2>
      </div>
      <div class="font-medium tracking-tight text-secondary mb-4">
        A continuación encontrará la información general de la actividad del
        grupo.
      </div>

      <div class="flex flex-col gap-4 mt-4">
        <!-- Botón de toggle -->
        <div class="flex w-full justify-end">
          <button class="flex items-center gap-2 px-4 py-2 bg-pink-500 hover:bg-pink-600 text-white rounded-full transition-colors duration-200 shadow-md" 
                  (click)="showImage()">
            <mat-icon class="">{{ showImg ? 'visibility' : 'visibility_off' }}</mat-icon>
            <span>{{ showImg ? 'Ocultar imágenes' : 'Mostrar imágenes' }}</span>
          </button>
        </div>
        
        <!-- Contenedor de imágenes -->
        <div *ngIf="!showImg" class="flex flex-col justify-center items-center">
          <!-- Imagen original -->
          <div class="w-full border border-gray-200 rounded-lg overflow-hidden shadow-lg bg-white transition-transform duration-300 hover:scale-[1.02]">
            <div class="p-3 bg-gray-50 border-b border-gray-200">
              <h3 class="font-medium text-gray-700">Imagen Original</h3>
            </div>
            <div class="p-2">
              <img [src]="dataSource.data[0]?.urlFileImageOriginal" 
                   [alt]="'Imagen original - ' + (dataSource.data[0]?.urlFileImageOriginal || '')"
                   class="w-full h-auto rounded-md object-contain max-h-96"/>
            </div>
          </div>
          
          <!-- Imagen procesada -->
          <div class=" w-full my-4 border border-gray-200 rounded-lg overflow-hidden shadow-lg bg-white transition-transform duration-300 hover:scale-[1.02]">
            <div class="p-3 bg-gray-50 border-b border-gray-200">
              <h3 class="font-medium text-gray-700">Imagen Procesada</h3>
            </div>
            <div class="p-2">
              <img [src]="dataSource.data[0]?.urlFileImageProcessed" 
                   [alt]="'Imagen procesada - ' + (dataSource.data[0]?.urlFileImageProcessed || '')"
                   class="w-full h-auto rounded-md object-contain max-h-96"/>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="w-full h-10 flex justify-center items-center my-6" *ngIf="!showImg">
      <button class="flex items-center gap-2 px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-md text-sm" (click)="report()">
        <mat-icon>warning</mat-icon>
        Reportar error
      </button>
    </div>

    <div
      class="flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden mt-4 h-auto"
    >
      <div class="overflow-x-auto p-4">
        <!-- <mat-form-field class="bg-white rounded-md w-full mt-4">
            <mat-label>Buscar en todos los campos</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Buscar"
              class="py-2 px-3 rounded-md shadow-sm text-gray-700 leading-5 focus:outline-none focus:shadow-outline-blue focus:border-blue-300">
          </mat-form-field> -->

        <div class="flex justify-between items-center w-full h-16">
          <div class="mt-2 mb-2 text-sm text-gray-700">
            Resultados: {{ dataSource.data.length }}
          </div>
        </div>

        <table
          class="w-full"
          mat-table
          matSort
          [dataSource]="dataSource"
          [trackBy]="trackByFn"
          #recordsTable="matSort"
        >
          <!-- Columna de selección (Checkbox) -->
          <ng-container matColumnDef="select">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let rowData"></td>
          </ng-container>

          <!-- Iteración de columnas sin incluir 'select' -->
          <ng-container
            *ngFor="let column of recordsTableColumns"
            [matColumnDef]="column"
          >
            <th mat-header-cell mat-sort-header *matHeaderCellDef>
              {{ columns[column] }}
            </th>

            <td
              mat-cell
              *matCellDef="let rowData"
              class="whitespace-nowrap py-2 px-3"
            >
              <span class="font-medium text-sm text-secondary">{{
                rowData[column]
              }}</span>
            </td>
          </ng-container>

          <!-- Columna de acciones -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Acciones</th>
            <td mat-cell *matCellDef="let transaction">
              <button
                mat-icon-button
                color="primary"
                [matMenuTriggerFor]="menu"
              >
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu class="bg-white" #menu="matMenu">
                <button mat-menu-item (click)="remove(transaction.id)">
                  <mat-icon>delete</mat-icon>
                  Prueba
                </button>
              </mat-menu>
            </td>
          </ng-container>

          <!-- Definir las filas usando displayedColumns -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: displayedColumns"
            [ngClass]="getRowBorderColor()"
          ></tr>
        </table>

        <div class="mt-4">
          <mat-paginator
            #paginator
            [length]="dataSource.data.length"
            [pageSize]="10"
            [pageSizeOptions]="[5, 10, 25, 100]"
          ></mat-paginator>
        </div>
      </div>
    </div>
  </div>
</div>
<app-loading *ngIf="loading"></app-loading>
<app-group-component-date-activity-beneficiary-add
  *ngIf="isFormVisible"
  (modal)="reciveEvent($event)"
>
</app-group-component-date-activity-beneficiary-add>

<app-modal-report-error-ia *ngIf="showFormError"
  [assistanceScannerId]="assistanceScannerId" 
  (modal)="closeModal($event)"></app-modal-report-error-ia>
